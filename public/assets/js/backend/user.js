(function(){APPMarket.Backend.BackendApp.filter("group_implode",function(){return function(e){return _.pluck(e,"name").join(", ")}}),APPMarket.Backend.BackendApp.filter("ucwords",function(){return function(e){return _.isString(e)?e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}):""}}),APPMarket.Backend.BackendApp.filter("in_users_group",function(){return function(e,t){var r;return r=_.findWhere(t,{id:e}),!_.isEmpty(r)&&!_.isUndefined(r)}}),APPMarket.Backend.BackendApp.filter("remove_namespace",function(){return function(e,t){return e.replace(t+".","")}}),APPMarket.Backend.BackendApp.controller("UserController",["$scope","$timeout","blockUI","ApiFactory","ListingService","SystemFactory","SweetAlertService","$filter",function(e,t,r,s,a,n,l,i){var o;return o=function(){function r(){e.resources=APPMarket.Resources,e.vars=APPMarket.Vars,e.link={root:e.resources.root,lists:e.resources.index},e.blockUI=e.blockui("blockui-effect"),e.details={},e.per_page=20,0===e.vars.hash_id&&0===e.vars.is_create?(e.pagePresetKey="APPMarket-page",e=angular.extend(e,a,{getCollections:function(t){return e.getOrderLists(t)}}),e.loadCollections(),e.details.allItemsSelected=!1):(e.details.roles=[],e.details.is_enabled=!0,e.group_list=e.vars.userRoles,0===e.vars.is_create&&e.getDetail())}return e.getDetail=function(){return e.blockUI.start("Please Wait . . ."),e.details.user_id=APPMarket.user_id,s.sendRequest({},e.link.lists+"/"+e.vars.hash_id,"GET").then(function(t){var r;return"error"===t.data.status?(e.alertMsg({msg:t.data.message}),e.blockUI.stop()):(r=t.data.data,e.details=r,_.each(e.group_list,function(t){return t.selected=i("in_users_group")(t.id,e.details.roles)}),e.blockUI.stop())})["catch"](function(r){if("error"===r.data.status)return e.alertMsg({msg:"No query results found, You will be redirected back in 2 seconds..."}),t(function(){return window.location.href=e.link.root},2e3)})},e.create=function(t){var r;try{return n.validateObj(e.details,["first_name","last_name","email","username","password"]),e.details.roles=_.where(e.group_list,{selected:!0}),e.blockUI.start("Please Wait . . ."),s.sendRequest(e.details,e.link.lists,"POST").then(function(t){var r;return r=t.data,window.location.href=r.data.backend_detail_url,e.blockUI.stop()})["catch"](function(t){return e.alertMsg({msg:t.data.message}),e.blockUI.stop()})}catch(a){return r=a,e.alertMsg({msg:r})}},r}(),e.update=function(t){var r;try{return e.details.roles=_.where(e.group_list,{selected:!0}),e.details.user_id=APPMarket.user_id,n.validateObj(e.details,["first_name","last_name","email","username"]),e.blockUI.start("Please Wait . . ."),s.sendRequest(e.details,e.link.lists+"/"+e.vars.hash_id,"PUT").then(function(t){var r;return r=t.data,e.alertMsg({msg:r.message,success:!0}),e.blockUI.stop()})["catch"](function(t){return e.alertMsg({msg:t.data.message}),e.blockUI.stop()})}catch(a){return r=a,e.alertMsg({msg:r}),e.blockUI.stop()}},e.loadCollections=function(){return t(function(){var t;return t=_h.get(e.pagePresetKey)||1,""!==e.details.search&&(t=1),e.getCollections(t)})},e.getOrderLists=function(r){var s,a,n;return r=r||1,e.blockUI.start("Please Wait . . ."),_h.set(e.pagePresetKey,r),e.details.per_page=angular.isUndefined(e.details.per_page)?e.per_page:e.details.per_page,e.details.search=angular.isUndefined(e.details.search)?"":e.details.search,n="&search="+e.details.search,s="&per_page="+e.details.per_page,a=e.link.lists+"?page="+r+n+s,e.requestData(a,"GET").success(function(r){return null!=r.data?angular.bind(e,e.dataHandler(r)):(_h.set(e.pagePresetKey,1),e.data=[],e.range=[],e.totalPages=0),t(function(){return e.blockUI.stop()},500)})},e.delRequest=function(t){return e.blockUI.start("Please Wait . . ."),s.sendRequest({},e.link.lists+"/"+t.id,"DELETE").then(function(t){return"error"===t.data.status?e.alertMsg({msg:t.data.message}):(e.alertMsg({msg:t.data.message,success:!0}),window.location.href=e.link.root),e.blockUI.stop()})},e.delModal=function(t){var r;return r={title:"Please Confirm",text:_h.sprintf("Do you want to delete this user (<strong>%s</strong>)?",t.full_name),html:!0,showCancelButton:!0,cancelButtonText:"Cancel"},l.swal(r,function(r){if(r)return e.delRequest(t)})},e.alertMsg=function(e){var t,r;return r={title:"System Response",msg:"Problem in your request!"},t=angular.merge(r,e),t.success===!0?l.success(t.title,t.msg):l.error(t.title,t.msg)},e.search=function(){return e.loadCollections()},e.clearAll=function(){return e.details={search:"",letter:"",per_page:20},e.loadCollections()},e._slug=function(e){return e.toString().toLowerCase().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")},e.perPageChange=function(){return e.loadCollections()},e.statusChange=function(){return e.isEdit=!1},e.blockui=function(e){return r.instances.get(e)},new o}])}).call(this);